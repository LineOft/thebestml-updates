<style>
    * { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%); min-height: 100vh; color: #fff; overflow-x: hidden; }
    .container { max-width: 500px; margin: 0 auto; padding: 20px; padding-top: 50px; padding-bottom: 100px; }
    .header { text-align: center; margin-bottom: 30px; }
    .logo { font-size: 60px; margin-bottom: 15px; }
    .title { font-size: 26px; font-weight: bold; margin-bottom: 8px; }
    .subtitle { color: #aaa; font-size: 14px; }
    .version { color: #666; font-size: 12px; margin-top: 5px; }
    .btn { display: block; width: 100%; padding: 18px 20px; border: none; border-radius: 15px; font-size: 16px; font-weight: bold; cursor: pointer; margin-bottom: 15px; transition: all 0.3s ease; text-align: center; }
    .btn:active { transform: scale(0.98); opacity: 0.9; }
    .btn-primary { background: linear-gradient(135deg, #4CAF50, #45a049); color: #fff; box-shadow: 0 4px 15px rgba(76, 175, 80, 0.4); }
    .btn-secondary { background: linear-gradient(135deg, #2196F3, #1976D2); color: #fff; box-shadow: 0 4px 15px rgba(33, 150, 243, 0.4); }
    .btn-warning { background: linear-gradient(135deg, #FF9800, #F57C00); color: #fff; }
    .btn-subtext { display: block; font-size: 12px; font-weight: normal; opacity: 0.8; margin-top: 5px; }
    .section { margin-bottom: 25px; }
    .section-title { font-size: 18px; font-weight: bold; margin-bottom: 15px; }
    .step-card { background: rgba(255,255,255,0.05); border: 2px solid rgba(255,255,255,0.1); border-radius: 12px; padding: 15px; margin-bottom: 10px; display: flex; align-items: center; cursor: pointer; transition: all 0.3s ease; }
    .step-card:active { background: rgba(76, 175, 80, 0.2); }
    .step-card.completed { border-color: #4CAF50; background: rgba(76, 175, 80, 0.15); }
    .step-number { width: 35px; height: 35px; border-radius: 50%; background: #0f3460; display: flex; align-items: center; justify-content: center; font-weight: bold; margin-right: 15px; }
    .step-card.completed .step-number { background: #4CAF50; }
    .step-content { flex: 1; }
    .step-title { font-weight: bold; margin-bottom: 3px; }
    .step-desc { color: #aaa; font-size: 12px; }
    .key-box { background: linear-gradient(135deg, #0f3460, #16213e); border: 2px solid #4CAF50; border-radius: 15px; padding: 20px; text-align: center; margin: 20px 0; }
    .key-label { color: #aaa; font-size: 14px; margin-bottom: 10px; }
    .key-value { font-size: 32px; font-weight: bold; color: #4CAF50; letter-spacing: 4px; font-family: monospace; }
    .key-copy { background: #4CAF50; color: #fff; border: none; padding: 12px 25px; border-radius: 10px; margin-top: 15px; cursor: pointer; font-weight: bold; font-size: 14px; }
    .features { background: rgba(255,255,255,0.05); border-radius: 15px; padding: 20px; }
    .feature-item { color: #aaa; font-size: 14px; margin-bottom: 10px; }
    .toast { position: fixed; bottom: 30px; left: 50%; transform: translateX(-50%) translateY(100px); background: #333; color: #fff; padding: 15px 30px; border-radius: 10px; z-index: 1002; transition: transform 0.3s ease; font-size: 14px; }
    .toast.show { transform: translateX(-50%) translateY(0); }
    .update-badge { display: none; background: #f44336; color: #fff; padding: 3px 8px; border-radius: 10px; font-size: 10px; margin-left: 10px; animation: pulse 2s infinite; }
    .update-badge.show { display: inline-block; }
    @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
</style>

<div class="container">
    <div class="header">
        <div class="logo">ðŸŽ®</div>
        <h1 class="title">TheBestML IMGUI V2.8</h1>
        <p class="subtitle">Otomatik Kurulum UygulamasÄ±</p>
        <p class="version">SÃ¼rÃ¼m: <span id="currentVersion">1.6.0</span></p>
    </div>

    <div class="section">
        <button class="btn btn-primary" onclick="oneTapInstall()">
            âš¡ TEK DOKUNUÅžTA KURULUM
            <span class="btn-subtext">TÃ¼m adÄ±mlarÄ± otomatik yapar</span>
        </button>
        
        <button class="btn" style="background: linear-gradient(135deg, #e91e63, #c2185b);" onclick="autoCertDisable()">
            ðŸ¤– OTOMATÄ°K SERTÄ°FÄ°KA KAPAT
            <span class="btn-subtext">GlobalSign hariÃ§ tÃ¼mÃ¼nÃ¼ kapat</span>
        </button>
        
        <button class="btn btn-secondary" onclick="downloadAPK()">
            ðŸ“¥ IMGUI APK Ä°NDÄ°R
            <span class="btn-subtext">TheBestML IMGUI V2.8</span>
        </button>
    </div>

    <div class="key-box">
        <div class="key-label">ðŸ”‘ GiriÅŸ Key'i</div>
        <div class="key-value" id="keyDisplay">THEBEST2024</div>
        <button class="key-copy" onclick="copyKey()">ðŸ“‹ KOPYALA</button>
    </div>

    <div class="section">
        <div class="section-title">ðŸ“Œ AdÄ±m AdÄ±m Kurulum</div>
        
        <div class="step-card" id="step1" onclick="openPlayStore()">
            <div class="step-number">1</div>
            <div class="step-content">
                <div class="step-title">Mobile Legends Ä°ndir</div>
                <div class="step-desc">Play Store'dan orijinal ML</div>
            </div>
        </div>
        
        <div class="step-card" id="step2" onclick="autoCertDisable()">
            <div class="step-number">2</div>
            <div class="step-content">
                <div class="step-title">ðŸ¤– SertifikalarÄ± Otomatik Kapat</div>
                <div class="step-desc">GlobalSign NV-SA hariÃ§ tÃ¼mÃ¼</div>
            </div>
        </div>
        
        <div class="step-card" id="step3" onclick="downloadAPK()">
            <div class="step-number">3</div>
            <div class="step-content">
                <div class="step-title">APK Ä°ndir ve Kur</div>
                <div class="step-desc">TheBestML IMGUI APK</div>
            </div>
        </div>
        
        <div class="step-card" id="step4" onclick="showKeyAlert()">
            <div class="step-number">4</div>
            <div class="step-content">
                <div class="step-title">Key ile GiriÅŸ</div>
                <div class="step-desc">ðŸ”‘ THEBEST2024</div>
            </div>
        </div>
    </div>

    <div class="section">
        <button class="btn btn-warning" onclick="openSecurityManual()">
            ðŸ”’ Manuel Sertifika AyarlarÄ±
        </button>
    </div>

    <div class="features">
        <div class="section-title">âœ¨ Ã–zellikler</div>
        <div class="feature-item">âœ… Orman YaratÄ±klarÄ±nÄ± GÃ¶rme</div>
        <div class="feature-item">âœ… Otomatik Kurulum</div>
        <div class="feature-item">âœ… Root & Rootsuz Destek</div>
        <div class="feature-item">âœ… TÃ¼m Android Telefonlarda Ã‡alÄ±ÅŸÄ±r</div>
        <div class="feature-item">âœ… OTA GÃ¼ncelleme (Otomatik)</div>
        <div class="feature-item">ðŸ¤– Otomatik Sertifika Kapatma</div>
    </div>
</div>

<div class="toast" id="toast"></div>

<script>
    // Capacitor Plugin referansÄ±
    let CertManager = null;
    
    // Config'i localStorage'dan al
    let appConfig = {
        version: '1.6.0',
        key: 'THEBEST2024',
        apkUrl: 'https://dosya.co/dho18v1fbzq0/THEBEST_IMGUI-v2.8.apk.html',
        playStoreUrl: 'https://play.google.com/store/apps/details?id=com.mobile.legends'
    };
    
    // Sayfa yÃ¼klendiÄŸinde
    document.addEventListener('DOMContentLoaded', function() {
        // Capacitor plugin'i al
        if (window.Capacitor && window.Capacitor.Plugins) {
            CertManager = window.Capacitor.Plugins.CertificateManager;
        }
        
        // localStorage'dan config yÃ¼kle
        try {
            const savedConfig = localStorage.getItem('thebestml_config');
            if (savedConfig) {
                const parsed = JSON.parse(savedConfig);
                appConfig = { ...appConfig, ...parsed };
            }
        } catch (e) {}
        
        // Versiyon ve key'i gÃ¶ster
        const savedVersion = localStorage.getItem('thebestml_app_version');
        if (savedVersion) document.getElementById('currentVersion').textContent = savedVersion;
        if (appConfig.key) document.getElementById('keyDisplay').textContent = appConfig.key;
    });

    // Otomatik Sertifika Kapatma
    async function autoCertDisable() {
        if (!CertManager) {
            alert('âš ï¸ Bu Ã¶zellik iÃ§in Ã¶nce eriÅŸilebilirlik izni vermeniz gerekiyor.\n\n' +
                  'Ayarlar > EriÅŸilebilirlik > Ä°ndirilen uygulamalar\n' +
                  '"TheBestML Installer" servisini aÃ§Ä±n.');
            return;
        }
        
        try {
            // Ä°zin kontrolÃ¼
            const result = await CertManager.checkAccessibilityPermission();
            
            if (!result.enabled) {
                const choice = confirm(
                    'ðŸ” EriÅŸilebilirlik Ä°zni Gerekli\n\n' +
                    'SertifikalarÄ± otomatik kapatmak iÃ§in izin vermeniz gerekiyor.\n\n' +
                    '1ï¸âƒ£ AÃ§Ä±lacak sayfada aÅŸaÄŸÄ± kaydÄ±rÄ±n\n' +
                    '2ï¸âƒ£ "Ä°ndirilen uygulamalar" veya "YÃ¼klÃ¼ hizmetler" bulun\n' +
                    '3ï¸âƒ£ "TheBestML Installer" bulun ve AÃ‡IN\n' +
                    '4ï¸âƒ£ Geri dÃ¶nÃ¼p tekrar deneyin\n\n' +
                    'AyarlarÄ± aÃ§mak iÃ§in Tamam\'a basÄ±n.'
                );
                
                if (choice) {
                    await CertManager.openAccessibilitySettings();
                }
                return;
            }
            
            // Ä°zin var, otomatik kapatmayÄ± baÅŸlat
            const startChoice = confirm(
                'ðŸ¤– Otomatik Sertifika Kapatma\n\n' +
                'âš ï¸ Bu iÅŸlem TÃœM sistem sertifikalarÄ±nÄ± kapatacak!\n' +
                'âœ… Sadece GlobalSign NV-SA aÃ§Ä±k kalacak.\n\n' +
                'ðŸ“ Åžimdi gÃ¼venilir kimlik bilgileri aÃ§Ä±lacak:\n' +
                '1ï¸âƒ£ "SÄ°STEM" sekmesine tÄ±klayÄ±n\n' +
                '2ï¸âƒ£ Uygulama otomatik Ã§alÄ±ÅŸacak\n' +
                '3ï¸âƒ£ Ä°ÅŸlem bitene kadar bekleyin\n\n' +
                'BaÅŸlatmak iÃ§in Tamam\'a basÄ±n.'
            );
            
            if (startChoice) {
                await CertManager.startAutoDisable();
                await CertManager.openTrustedCredentials();
                completeStep(2);
                showToast('ðŸ¤– Otomatik kapatma baÅŸladÄ±!');
            }
            
        } catch (error) {
            console.error('Hata:', error);
            alert('âŒ Hata: ' + error.message);
        }
    }

    // Manuel gÃ¼venlik ayarlarÄ±
    async function openSecurityManual() {
        alert('ðŸ”’ Manuel Sertifika Kapatma\n\n' +
            '1ï¸âƒ£ Ayarlar > GÃ¼venlik\n' +
            '2ï¸âƒ£ "DiÄŸer gÃ¼venlik ayarlarÄ±" veya\n' +
            '     "Åžifreleme ve kimlik bilgileri"\n' +
            '3ï¸âƒ£ "GÃ¼venilen kimlik bilgileri"\n' +
            '4ï¸âƒ£ "SÄ°STEM" sekmesi\n' +
            '5ï¸âƒ£ Her sertifikaya tÄ±klayÄ±p "Devre dÄ±ÅŸÄ± bÄ±rak"\n\n' +
            'âš ï¸ GlobalSign NV-SA AÃ‡IK kalmalÄ±!');
        
        if (CertManager) {
            try {
                await CertManager.openSecuritySettings();
            } catch (e) {}
        }
    }

    function oneTapInstall() {
        alert('ðŸš€ Kurulum BaÅŸlÄ±yor!\n\n' +
            '1ï¸âƒ£ Mobile Legends indir\n' +
            '2ï¸âƒ£ SertifikalarÄ± otomatik kapat\n' +
            '3ï¸âƒ£ IMGUI APK indir ve kur\n' +
            '4ï¸âƒ£ Key ile giriÅŸ\n\n' +
            'Åžimdi Play Store aÃ§Ä±lacak.');
        openPlayStore();
    }

    function openPlayStore() {
        completeStep(1);
        window.open(appConfig.playStoreUrl, '_system');
        showToast('ðŸ“± Play Store aÃ§Ä±ldÄ±');
    }

    function downloadAPK() {
        completeStep(3);
        window.open(appConfig.apkUrl, '_system');
        showToast('ðŸ“¥ Ä°ndirme baÅŸladÄ±');
    }

    function showKeyAlert() {
        completeStep(4);
        alert('ðŸ”‘ GiriÅŸ Key\'i\n\n' +
            'Klonlanan ML\'yi aÃ§Ä±n ve bu key ile giriÅŸ yapÄ±n:\n\n' +
            'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n' +
            '   ðŸ”‘ ' + appConfig.key + '\n' +
            'â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”');
    }

    function copyKey() {
        const key = appConfig.key;
        if (navigator.clipboard) {
            navigator.clipboard.writeText(key).then(() => showToast('âœ… Key kopyalandÄ±: ' + key));
        } else {
            const input = document.createElement('input');
            input.value = key;
            document.body.appendChild(input);
            input.select();
            document.execCommand('copy');
            document.body.removeChild(input);
            showToast('âœ… Key kopyalandÄ±: ' + key);
        }
    }

    function completeStep(stepNum) {
        const step = document.getElementById('step' + stepNum);
        if (step) step.classList.add('completed');
    }

    function showToast(message) {
        const toast = document.getElementById('toast');
        toast.textContent = message;
        toast.classList.add('show');
        setTimeout(() => toast.classList.remove('show'), 3000);
    }
</script>
